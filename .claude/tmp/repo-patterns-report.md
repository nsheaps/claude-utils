# NSheaps Repository Patterns Report

## Overview

This report documents the standardized repository patterns used across the nsheaps ecosystem, specifically examining:
- `/Users/nathan.heaps/src/nsheaps/claude-utils` (primary reference)
- `/Users/nathan.heaps/src/nsheaps/git-wt` (secondary reference - CLI/Homebrew pattern)
- `/Users/nathan.heaps/src/nsheaps/ai` (tertiary reference - complex monorepo pattern)

**Status:** `agent-team` repo does NOT exist yet. Ready to initialize with patterns below.

---

## 1. Root Configuration Files

### 1.1 mise.toml

**Location:** `/mise.toml` (project root)

**Purpose:** Development environment and task runner configuration

**claude-utils pattern:**
```toml
[tools]
node = "lts"
yarn = "4"

[tasks.test]
description = "Run CLI tests"
run = "bash test/cli-test.sh"

[tasks.lint]
description = "Check bash syntax for all scripts"
run = """
find bin -type f -name '*.sh' -o -type f ! -name '*.*' | while read -r script; do
  if head -1 "$script" | grep -q 'bash'; then
    echo "Checking $script..."
    bash -n "$script"
  fi
done
echo "All scripts passed syntax check."
"""

[tasks.lint-formula]
description = "Lint Homebrew formula with rubocop"
run = "rubocop Formula/*.rb --config .rubocop.yml"
```

**git-wt pattern (simpler):**
```toml
[tools]
node = "lts"
yarn = "4"

[tasks.test]
description = "Run CLI tests"
run = "bash test/cli-test.sh"

[tasks.lint]
description = "Check bash syntax"
run = "bash -n bin/git-wt"
```

**ai pattern (complex monorepo):**
```toml
[tools]
gh = "latest"
jq = "latest"
node = "lts"
python = "3.14.2"
bun = "latest"
just = "latest"
"npm:prettier" = "latest"
"npm:eslint" = "latest"
yarn = "latest"

[settings]
legacy_version_file = false
```

**Recommendation for agent-team:**
Use a variation similar to git-wt/claude-utils for a TypeScript/Node.js project. Include tasks for:
- `test`: Run test suite
- `lint`: Code quality checks
- `build`: Compile/bundle if needed
- `fmt`: Code formatting

---

### 1.2 package.json

**Location:** `./package.json` (project root)

**claude-utils pattern:**
```json
{
  "name": "claude-utils",
  "version": "0.1.0",
  "private": true,
  "description": "CLI utilities for Claude Code workflow management",
  "repository": {
    "type": "git",
    "url": "https://github.com/nsheaps/claude-utils.git"
  },
  "license": "MIT",
  "devDependencies": {
    "@release-it/conventional-changelog": "^10.0.0",
    "release-it": "^19.2.4"
  },
  "packageManager": "yarn@4.12.0+sha512.f45ab632439a67f8bc759bf32ead036a1f413287b9042726b7cc4818b7b49e14e9423ba49b18f9e06ea4941c1ad062385b1d8760a8d5091a1a31e5f6219afca8"
}
```

**Key patterns:**
- `"private": true` for all CLI/infrastructure repos
- `"version"` should match release tag format (semantic versioning)
- Include full `packageManager` string with SHA for reproducibility
- Only essential devDependencies (release-it + changelog plugin)
- Always include `repository` with HTTPS URL

**Recommendation for agent-team:**
Follow claude-utils pattern, adjust devDependencies based on whether you need:
- TypeScript compilation
- Linting (ESLint)
- Testing frameworks (Jest, Vitest)

---

### 1.3 .yarnrc.yml

**Location:** `./.yarnrc.yml` (project root)

**Standard pattern:**
```yaml
nodeLinker: node-modules
```

**Simple and consistent across all repos.** No customization needed per project.

---

### 1.4 .gitignore

**claude-utils pattern:**
```
# Dependencies
node_modules/
.pnp.*
.yarn/*
!.yarn/patches
!.yarn/plugins
!.yarn/releases
!.yarn/sdks
!.yarn/versions

# Build outputs
dist/
*.tar.gz

# IDE
.idea/
.vscode/
*.swp
*.swo
*~

# OS
.DS_Store
Thumbs.db

# Test artifacts
test/tmp/

# mise local config
.mise.local.toml
```

**ai pattern (more comprehensive):**
```
# OS Files
.DS_Store
Thumbs.db
desktop.ini

# Editor directories and files
.vscode/
.idea/
*.swp
*.swo
*~
.project
.classpath
.settings/
*.sublime-workspace
*.sublime-project

# Node modules
node_modules/
npm-debug.log*
yarn-debug.log*
yarn-error.log*

# Yarn PnP files (generated on yarn install)
.pnp.*
.yarn/cache/
.yarn/install-state.gz
.yarn/unplugged/

# Environment variables
.env
.env.local
.env.*.local
.env.development
.env.production

# Claude Code personal settings
.claude/settings.local.json

# Autogenerated sync documentation (contains machine-specific paths)
.claude/rules/upstream--*.md

# Logs
logs/
*.log

# Temporary files
tmp/
temp/
*.tmp

# Build outputs
dist/
build/
out/

# Coverage reports
coverage/
*.lcov
.nyc_output/

# Testing
.cache/

# macOS
._*

# Windows
ehthumbs.db
ehthumbs_vista.db

# Linux
*~

# Backup files
*.bak
*.backup
.claude/ralph-loop.local.md
```

**Recommendation for agent-team:**
Use claude-utils base pattern, add these if applicable:
- `.env.local` / `.env*.local` (if using environment variables)
- `build/` (if compiling TypeScript)
- `coverage/` (if using code coverage)
- `.claude/settings.local.json` (Claude Code user settings)

---

### 1.5 .editorconfig

**ai pattern (comprehensive):**
```
# http://editorconfig.org
root = true

[*]
indent_style = space
indent_size = 2
end_of_line = lf
charset = utf-8
trim_trailing_whitespace = true
insert_final_newline = true

# Use 4 spaces for the Python files
[*.py]
indent_size = 4
max_line_length = 80

# The JSON files contain newlines inconsistently
[*.json]
insert_final_newline = ignore

# Minified JavaScript files shouldn't be changed
[**.min.js]
indent_style = ignore
insert_final_newline = ignore

# Makefiles always use tabs for indentation
[Makefile]
indent_style = tab

# Batch files use tabs for indentation
[*.bat]
indent_style = tab

[*.md]
trim_trailing_whitespace = false
```

**Note:** claude-utils and git-wt do NOT have .editorconfig. It's optional but valuable for multi-language repos.

**Recommendation for agent-team:**
Include .editorconfig if the project will have mixed file types (TypeScript, YAML, Markdown, etc.)

---

### 1.6 .prettierrc.yaml

**ai pattern:**
```yaml
# Prettier configuration
# https://prettier.io/docs/en/configuration.html

# General settings
printWidth: 100
tabWidth: 2
useTabs: false
endOfLine: lf

# Only format these file types
overrides:
  - files:
      - '*.yaml'
      - '*.yml'
    options:
      singleQuote: true
  - files:
      - '*.json'
    options:
      trailingComma: none
  - files:
      - '*.md'
    options:
      proseWrap: preserve
```

**Note:** claude-utils and git-wt do NOT have prettier configs. Used only in ai repo.

**Recommendation for agent-team:**
Include if project will format TypeScript/JavaScript. Add overrides for YAML and Markdown if needed.

---

### 1.7 .prettierignore

**ai pattern:**
```
node_modules
.git
*.lock
package-lock.json
claude-remote-env-snapshot
```

**Note:** Only in ai repo. Skip if not using prettier.

---

### 1.8 LICENSE

**Standard pattern across all repos:**
```
MIT License

Copyright (c) 2026 Nathan Heaps

Permission is hereby granted, free of charge, to any person obtaining a copy
of this software and associated documentation files (the "Software"), to deal
in the Software without restriction, including without limitation the rights
to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
copies of the Software, and to permit persons to whom the Software is
furnished to do so, subject to the following conditions:

The above copyright notice and this permission notice shall be included in all
copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
SOFTWARE.
```

**Recommendation:** Use MIT with 2026 copyright year. Update annually if modified.

---

### 1.9 .rubocop.yml

**claude-utils pattern:**
```yaml
---
AllCops:
  NewCops: enable

Metrics/BlockLength:
  Enabled: false

Layout/LineLength:
  AllowedPatterns:
    - "# renovate: .*"

Naming/FileName:
  Enabled: false

Style/FrozenStringLiteralComment:
  Enabled: false

Style/Documentation:
  Enabled: false
```

**Note:** Only in repos with Ruby Homebrew formulas (claude-utils, git-wt).

**Recommendation for agent-team:**
Include ONLY if you're distributing via Homebrew and have Ruby formula files.

---

### 1.10 renovate.json

**Standard pattern across all repos:**
```json
{
  "$schema": "https://docs.renovatebot.com/renovate-schema.json",
  "extends": ["github>nsheaps/renovate-config"]
}
```

**Purpose:** Enables Renovate dependency updates, extending shared configuration from nsheaps/renovate-config.

**Recommendation:** Include in all nsheaps repositories for automated dependency management.

---

### 1.11 .release-it.json

**claude-utils pattern:**
```json
{
  "hooks": {
    "after:bump": "sed -i.bak 's/^CLAUDE_UTILS_VERSION=.*/CLAUDE_UTILS_VERSION=\"v${version}\"/' bin/lib/claude.lib.sh && rm -f bin/lib/claude.lib.sh.bak"
  },
  "git": {
    "commitMessage": "chore: release v${version} [skip ci]",
    "tagName": "v${version}",
    "tagAnnotation": "Release v${version}",
    "requireCleanWorkingDir": false,
    "getLatestTagFromAllRefs": true
  },
  "github": {
    "release": true,
    "autoGenerate": true
  },
  "npm": false,
  "plugins": {
    "@release-it/conventional-changelog": {
      "preset": {
        "name": "conventionalcommits",
        "types": [
          { "type": "feat", "section": "Features" },
          { "type": "fix", "section": "Bug Fixes" },
          { "type": "perf", "section": "Performance" },
          { "type": "refactor", "section": "Refactoring" },
          { "type": "docs", "section": "Documentation" },
          { "type": "chore", "section": "Maintenance" }
        ]
      },
      "infile": "CHANGELOG.md",
      "header": "# Changelog",
      "gitRawCommitsOpts": {
        "firstParent": false
      }
    }
  }
}
```

**git-wt pattern (nearly identical, different version bump location):**
```json
{
  "hooks": {
    "after:bump": "sed -i 's/^GIT_WT_VERSION=.*/GIT_WT_VERSION=\"v${version}\"/' bin/git-wt"
  },
  "git": {
    "commitMessage": "chore: release v${version} [skip ci]",
    "tagName": "v${version}",
    "tagAnnotation": "Release v${version}",
    "requireCleanWorkingDir": false,
    "getLatestTagFromAllRefs": true
  },
  "github": {
    "release": true,
    "autoGenerate": true
  },
  "npm": false,
  "plugins": {
    "@release-it/conventional-changelog": {
      "preset": {
        "name": "conventionalcommits",
        "types": [
          { "type": "feat", "section": "Features" },
          { "type": "fix", "section": "Bug Fixes" },
          { "type": "perf", "section": "Performance" },
          { "type": "refactor", "section": "Refactoring" },
          { "type": "docs", "section": "Documentation" },
          { "type": "chore", "section": "Maintenance" }
        ]
      },
      "infile": "CHANGELOG.md",
      "header": "# Changelog",
      "gitRawCommitsOpts": {
        "firstParent": false
      }
    }
  }
}
```

**Key points:**
- Disables npm publishing (`"npm": false`)
- Enables GitHub releases with auto-generated content
- Uses conventional commits for changelog generation
- Hooks can bump version strings in shell scripts
- Always uses `v${version}` tag format

**Recommendation for agent-team:**
Customize the `after:bump` hook if you have version strings to update. If not, can be omitted or set to empty.

---

## 2. Directory Structure

### 2.1 Standard Layout

All repos follow this basic structure:

```
repo-root/
├── .claude/                      # Claude Code configuration
│   └── settings.json             # Plugin/feature settings
├── .github/
│   ├── workflows/                # GitHub Actions
│   │   ├── test.yaml
│   │   └── release.yaml
│   └── actions/                  # Custom GitHub Actions (if needed)
│       └── github-app-auth/
│           └── action.yml
├── bin/                          # Executable scripts/binaries
│   └── lib/                      # Shared bash libraries (optional)
├── docs/                         # Documentation
├── Formula/                      # Homebrew formula (Homebrew repos only)
├── test/                         # Test files
│   ├── cli-test.sh
│   └── tmp/                      # Test artifacts (gitignored)
├── .editorconfig                 # (optional, ai repo pattern)
├── .gitignore
├── .prettierignore               # (optional, ai repo only)
├── .prettierrc.yaml              # (optional, ai repo only)
├── .release-it.json              # Release automation
├── .rubocop.yml                  # Ruby linting (Homebrew repos)
├── .yarnrc.yml
├── LICENSE
├── mise.toml                     # Task runner config
├── package.json
├── README.md
├── renovate.json                 # Dependency updates
└── yarn.lock
```

### 2.2 .claude/ Configuration

**Standard pattern:**
```
.claude/
└── settings.json
```

**settings.json (claude-utils):**
```json
{
  "$schema": "https://json.schemastore.org/claude-code-settings.json",
  "enabledPlugins": {
    "plugin-dev@claude-plugins-official": true
  }
}
```

**Recommendation for agent-team:**
Minimal settings. Only add plugins if needed.

---

## 3. GitHub Actions Workflows

### 3.1 Test Workflow (test.yaml)

**claude-utils pattern:**
```yaml
name: Test

on:
  push:
    branches:
      - main
  pull_request:

jobs:
  lint:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4

      - name: Check bash syntax
        run: |
          for script in bin/*; do
            # Skip directories (like bin/lib/)
            [[ -d "$script" ]] && continue
            echo "Checking $script..."
            bash -n "$script"
          done
          # Also check library files
          for lib in bin/lib/*.sh; do
            echo "Checking $lib..."
            bash -n "$lib"
          done
          echo "All scripts passed syntax check."

  test:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4

      - name: Setup mise
        uses: jdx/mise-action@v2

      - name: Install test dependencies
        run: |
          # Install fzf for cc-resume
          sudo apt-get update
          sudo apt-get install -y fzf

      - name: Run tests
        run: mise run test
```

**git-wt pattern (simpler, bash-only):**
```yaml
name: Test

on:
  push:
    branches:
      - main
  pull_request:

jobs:
  lint:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4

      - name: Check bash syntax
        run: |
          for script in bin/*; do
            [[ -d "$script" ]] && continue
            echo "Checking $script..."
            bash -n "$script"
          done
          echo "All scripts passed syntax check."

  test:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4

      - name: Setup mise
        uses: jdx/mise-action@v2

      - name: Run tests
        run: mise run test
```

**Key points:**
- Always trigger on `main` branch pushes and pull requests
- Use `jdx/mise-action@v2` for consistent environment setup
- Lint and test jobs run in parallel
- Install system dependencies as needed (fzf, gum, etc.)
- Call `mise run test` to execute test task

**Recommendation for agent-team:**
Adapt pattern based on project type. Add test dependencies as needed.

---

### 3.2 Release Workflow (release.yaml)

**claude-utils complex pattern with Homebrew formula update:**

```yaml
name: Release

on:
  push:
    branches:
      - main

permissions:
  contents: write
  actions: read

jobs:
  release:
    runs-on: ubuntu-latest
    outputs:
      version: ${{ steps.release.outputs.version }}
      tag: ${{ steps.release.outputs.tag }}
    steps:
      - uses: actions/checkout@v4
        with:
          fetch-depth: 0

      - name: Authenticate as GitHub App
        id: auth
        uses: ./.github/actions/github-app-auth
        with:
          app-id: ${{ secrets.AUTOMATION_GITHUB_APP_ID }}
          private-key: ${{ secrets.AUTOMATION_GITHUB_APP_PRIVATE_KEY }}

      - name: Fetch tags
        run: git fetch --tags --force

      - name: Setup mise
        uses: jdx/mise-action@v2

      - name: Install dependencies
        run: yarn install

      - name: Run release-it
        id: release
        run: |
          yarn release-it --ci
          TAG=$(git describe --tags --abbrev=0)
          echo "tag=$TAG" >> "$GITHUB_OUTPUT"
          echo "version=${TAG#v}" >> "$GITHUB_OUTPUT"

  update-homebrew:
    needs: release
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
        with:
          persist-credentials: false

      - name: Get job context
        id: context
        uses: qoomon/actions--context@v4

      - name: Authenticate as GitHub App
        id: auth
        uses: ./.github/actions/github-app-auth
        with:
          app-id: ${{ secrets.AUTOMATION_GITHUB_APP_ID }}
          private-key: ${{ secrets.AUTOMATION_GITHUB_APP_PRIVATE_KEY }}

      - name: Get release info
        id: release
        run: |
          VERSION="${{ needs.release.outputs.version }}"
          TAG="${{ needs.release.outputs.tag }}"
          echo "version=$VERSION" >> "$GITHUB_OUTPUT"
          echo "tag=$TAG" >> "$GITHUB_OUTPUT"

          # Download archive tarball and calculate SHA256
          TARBALL_URL="https://github.com/${{ github.repository }}/archive/refs/tags/${TAG}.tar.gz"
          echo "Downloading tarball from: $TARBALL_URL"
          curl -fsSL "$TARBALL_URL" -o /tmp/archive.tar.gz
          SHA256=$(shasum -a 256 /tmp/archive.tar.gz | cut -d' ' -f1)
          echo "sha256=$SHA256" >> "$GITHUB_OUTPUT"
          echo "Successfully got SHA256: $SHA256"

      - name: Clone homebrew-devsetup
        run: |
          gh repo clone nsheaps/homebrew-devsetup homebrew-devsetup

      - name: Install gomplate
        run: |
          curl -fsSL https://github.com/hairyhenderson/gomplate/releases/latest/download/gomplate_linux-amd64 -o /usr/local/bin/gomplate
          chmod +x /usr/local/bin/gomplate

      - name: Generate formula from template
        env:
          Tag: ${{ steps.release.outputs.tag }}
          SHA256: ${{ steps.release.outputs.sha256 }}
        run: |
          gomplate -f Formula/claude-utils.rb.gotmpl -o homebrew-devsetup/Formula/claude-utils.rb

      - name: Create PR to update formula with auto-merge
        env:
          RELEASE_URL: https://github.com/${{ github.repository }}/releases/tag/${{ steps.release.outputs.tag }}
          JOB_URL: ${{ env.GITHUB_JOB_URL }}
          VERSION: ${{ steps.release.outputs.version }}
          TAG: ${{ steps.release.outputs.tag }}
        run: |
          cd homebrew-devsetup
          BRANCH="bump-claude-utils-${VERSION}"
          git checkout -b "$BRANCH"
          git add Formula/claude-utils.rb
          git commit -m "chore: update claude-utils to ${VERSION}"
          git push -u origin "$BRANCH"

          # Create PR body file
          cat > /tmp/pr-body.md << 'BODY_EOF'
          Automated formula update from claude-utils release
          BODY_EOF
          echo "" >> /tmp/pr-body.md
          echo "**Release:** ${RELEASE_URL}" >> /tmp/pr-body.md
          echo "**Workflow:** ${JOB_URL}" >> /tmp/pr-body.md

          PR_URL=$(gh pr create \
            --title "chore: update claude-utils to ${VERSION}" \
            --body-file /tmp/pr-body.md \
            --base main)
          # Enable auto-merge with squash
          gh pr merge "$PR_URL" --auto --squash
```

**Key points:**
- Uses GitHub App authentication for CI automation
- Runs `yarn release-it --ci` to bump version and create GitHub release
- Outputs version/tag for downstream jobs
- Second job updates Homebrew formula in nsheaps/homebrew-devsetup
- Uses gomplate to template formula with release metadata
- Auto-merges PR with squash strategy

**Custom GitHub Action: github-app-auth**

Location: `.github/actions/github-app-auth/action.yml`

```yaml
name: "GitHub App Authentication"
description: "Authenticate as a GitHub App and configure git user settings"

branding:
  icon: "lock"
  color: "blue"

inputs:
  app-id:
    description: "GitHub App ID"
    required: true

  private-key:
    description: "GitHub App private key"
    required: true

  owner:
    description: "Repository owner (defaults to current repository owner)"
    required: false
    default: ${{ github.repository_owner }}

outputs:
  token:
    description: "GitHub App token"
    value: ${{ steps.app-token.outputs.token }}

  app-slug:
    description: "GitHub App slug name"
    value: ${{ steps.app-token.outputs.app-slug }}

  user-id:
    description: "GitHub App bot user ID"
    value: ${{ steps.get-user-id.outputs.user-id }}

  user-name:
    description: "GitHub App bot user name (app slug with [bot] suffix)"
    value: ${{ steps.get-user-id.outputs.user-name }}

runs:
  using: "composite"
  steps:
    - name: Generate GitHub App token
      id: app-token
      uses: actions/create-github-app-token@v2
      with:
        app-id: ${{ inputs.app-id }}
        private-key: ${{ inputs.private-key }}
        owner: ${{ inputs.owner }}

    - name: Get GitHub App User ID
      id: get-user-id
      shell: bash
      run: |
        echo "user-id=$(gh api "/users/${{ steps.app-token.outputs.app-slug }}[bot]" --jq .id)" >> "$GITHUB_OUTPUT"
        echo "user-name=${{ steps.app-token.outputs.app-slug }}[bot]" >> "$GITHUB_OUTPUT"
      env:
        GH_TOKEN: ${{ steps.app-token.outputs.token }}

    - name: Configure git
      shell: bash
      env:
        GH_TOKEN: ${{ steps.app-token.outputs.token }}
      run: |
        gh auth setup-git
        echo "GH_TOKEN=${GH_TOKEN}" >> $GITHUB_ENV
        echo "GITHUB_TOKEN=${GH_TOKEN}" >> $GITHUB_ENV
        git config --global user.name '${{ steps.get-user-id.outputs.user-name }}'
        git config user.name '${{ steps.get-user-id.outputs.user-name }}'
        git config --global user.email '${{ steps.get-user-id.outputs.user-id }}+${{ steps.get-user-id.outputs.user-name }}@users.noreply.github.com'
        git config user.email '${{ steps.get-user-id.outputs.user-id }}+${{ steps.get-user-id.outputs.user-name }}@users.noreply.github.com'

    - name: Configure repo checkout token
      uses: actions/checkout@v6
      with:
        token: ${{ steps.app-token.outputs.token }}
        clean: false
        persist-credentials: true
```

**Recommendation for agent-team:**
- If distributing via Homebrew: use full claude-utils workflow pattern
- If Node.js/TypeScript lib with npm publishing: create simpler release pattern
- If no distribution: skip release job entirely

---

## 4. Homebrew Formula Structure

### 4.1 Formula Template

**Location:** `Formula/claude-utils.rb.gotmpl`

```ruby
# typed: false
# frozen_string_literal: true

class ClaudeUtils < Formula
  desc 'CLI utilities for Claude Code workflow management'
  homepage 'https://github.com/nsheaps/claude-utils'
  url 'https://github.com/nsheaps/claude-utils/archive/refs/tags/{{ .Env.Tag }}.tar.gz'
  sha256 '{{ .Env.SHA256 }}'
  license 'MIT'

  head do
    url 'https://github.com/nsheaps/claude-utils.git', branch: 'main'
  end

  depends_on 'fzf'
  depends_on 'gum'

  def install
    bin.install Dir['bin/*']
  end

  test do
    assert_match 'ccresume', shell_output("#{bin}/ccresume --help 2>&1", 1)
  end
end
```

**Key patterns:**
- Class name is CamelCase version of formula name
- Uses gomplate syntax `{{ .Env.VAR }}` for dynamic content
- Dependencies listed explicitly
- Install phase copies bin/* to /usr/local/bin
- Test phase validates at least one command works

**Recommendation for agent-team:**
- Only include if distributing via Homebrew
- Adjust dependencies based on project needs
- Create corresponding symlink or copy logic for all executables

---

## 5. README Pattern

**claude-utils README highlights:**

```markdown
# claude-utils

CLI utilities for Claude Code workflow management.

## Installation

\`\`\`bash
brew tap nsheaps/devsetup
brew install claude-utils
\`\`\`

## Commands

[Table of commands organized by category]

## Usage Examples

\`\`\`bash
# Examples for each command
\`\`\`

## Dependencies

- fzf
- claude (must be installed separately)

## Development

\`\`\`bash
# Install dependencies
yarn install

# Run tests
mise run test

# Check bash syntax
mise run lint

# Lint formula
mise run lint-formula
\`\`\`

## License

MIT
```

**Recommendation:**
Include sections:
1. Description
2. Installation (Homebrew, manual build, etc.)
3. Commands/Features
4. Usage examples
5. Dependencies
6. Development setup
7. License

---

## 6. Test Structure

**Standard pattern:**
- Location: `test/cli-test.sh` (bash script)
- Invoked via: `mise run test`
- Creates temporary test artifacts in `test/tmp/` (gitignored)

**Recommendation:**
- Create test directory with executable test scripts
- Can be bash, Node.js, Python, or language-specific
- Ensure all tests run quickly in CI

---

## Summary: Template for agent-team

When initializing the agent-team repo, use this checklist:

### Required Files (All Projects)
- [ ] `.gitignore` — Base pattern from claude-utils
- [ ] `.yarnrc.yml` — Standard: `nodeLinker: node-modules`
- [ ] `LICENSE` — MIT with 2026 copyright
- [ ] `mise.toml` — Customize tasks for project
- [ ] `package.json` — Adjust dependencies
- [ ] `README.md` — Document the project
- [ ] `renovate.json` — Standard extends pattern
- [ ] `.release-it.json` — Customize version bump hook
- [ ] `.github/workflows/test.yaml` — Standard test workflow
- [ ] `.github/workflows/release.yaml` — Customize based on distribution

### Optional Files (Context-Dependent)
- [ ] `.editorconfig` — Include if multi-language
- [ ] `.prettierrc.yaml` — Include if formatting TypeScript/JS
- [ ] `.prettierignore` — If using prettier
- [ ] `.rubocop.yml` — Only if distributing Ruby
- [ ] `Formula/*.rb.gotmpl` — Only if Homebrew distribution
- [ ] `.claude/settings.json` — Include if using Claude Code plugins

### Directories
- [ ] `bin/` — Executables/CLI scripts
- [ ] `bin/lib/` — Shared bash/script libraries (optional)
- [ ] `docs/` — Documentation
- [ ] `src/` or `lib/` — Source code (if applicable)
- [ ] `test/` — Test files
- [ ] `.github/workflows/` — CI/CD workflows
- [ ] `.github/actions/` — Custom actions (if needed)
- [ ] `.claude/` — Claude Code config

---

## 7. Dependency Versions

**Key tool versions:**
- node: LTS (18 or 20)
- yarn: 4.x
- mise: latest (configured via task runner)
- GitHub Actions: @v4 (checkout), @v2 (mise-action)

**Release tools:**
- release-it: ^19.2.x
- @release-it/conventional-changelog: ^10.0.0

---

## 8. Reference Files

**Files examined for this report:**

### claude-utils
- `/Users/nathan.heaps/src/nsheaps/claude-utils/mise.toml`
- `/Users/nathan.heaps/src/nsheaps/claude-utils/package.json`
- `/Users/nathan.heaps/src/nsheaps/claude-utils/.gitignore`
- `/Users/nathan.heaps/src/nsheaps/claude-utils/.yarnrc.yml`
- `/Users/nathan.heaps/src/nsheaps/claude-utils/.release-it.json`
- `/Users/nathan.heaps/src/nsheaps/claude-utils/.rubocop.yml`
- `/Users/nathan.heaps/src/nsheaps/claude-utils/renovate.json`
- `/Users/nathan.heaps/src/nsheaps/claude-utils/LICENSE`
- `/Users/nathan.heaps/src/nsheaps/claude-utils/README.md`
- `/Users/nathan.heaps/src/nsheaps/claude-utils/.claude/settings.json`
- `/Users/nathan.heaps/src/nsheaps/claude-utils/.github/workflows/test.yaml`
- `/Users/nathan.heaps/src/nsheaps/claude-utils/.github/workflows/release.yaml`
- `/Users/nathan.heaps/src/nsheaps/claude-utils/.github/actions/github-app-auth/action.yml`
- `/Users/nathan.heaps/src/nsheaps/claude-utils/Formula/claude-utils.rb.gotmpl`

### git-wt
- `/Users/nathan.heaps/src/nsheaps/git-wt/mise.toml`
- `/Users/nathan.heaps/src/nsheaps/git-wt/package.json`
- `/Users/nathan.heaps/src/nsheaps/git-wt/.release-it.json`

### ai (complex monorepo reference)
- `/Users/nathan.heaps/src/nsheaps/ai/.mise.toml`
- `/Users/nathan.heaps/src/nsheaps/ai/.gitignore`
- `/Users/nathan.heaps/src/nsheaps/ai/.editorconfig`
- `/Users/nathan.heaps/src/nsheaps/ai/.prettierrc.yaml`
- `/Users/nathan.heaps/src/nsheaps/ai/.prettierignore`
- `/Users/nathan.heaps/src/nsheaps/ai/renovate.json`
- `/Users/nathan.heaps/src/nsheaps/ai/package.json`

---

**Report Generated:** 2026-02-15  
**Status:** agent-team repo does not yet exist — ready for initialization  
**Recommendation:** Follow claude-utils as base template, customize for agent-team's specific language and distribution model
